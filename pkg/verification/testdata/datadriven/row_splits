# Cannot split on empty or 1 row tables.

exec all
CREATE TABLE test_table (id INT4 PRIMARY KEY)
----
[conn 0] CREATE TABLE
[conn 1] CREATE TABLE

verify splits=4
----
[STATUS] unable to identify a split for primary key public.test_table, defaulting to a full scan
[STATUS] starting verify on public.test_table, shard 1/1
[STATUS] finished row verification on public.test_table (shard 1/1): truth rows seen: 0, success: 0, missing: 0, mismatch: 0, extraneous: 0

exec all
INSERT INTO test_table VALUES (1)
----
[conn 0] INSERT 0 1
[conn 1] INSERT 0 1

verify splits=4
----
[STATUS] unable to identify a split for primary key public.test_table, defaulting to a full scan
[STATUS] starting verify on public.test_table, shard 1/1
[STATUS] finished row verification on public.test_table (shard 1/1): truth rows seen: 1, success: 1, missing: 0, mismatch: 0, extraneous: 0

# 2 rows table can be split, but ranges may be jank.

exec all
INSERT INTO test_table VALUES (2)
----
[conn 0] INSERT 0 1
[conn 1] INSERT 0 1

verify splits=4
----
[STATUS] starting verify on public.test_table, shard 1/4, range: [<beginning> - 1)
[STATUS] finished row verification on public.test_table (shard 1/4): truth rows seen: 0, success: 0, missing: 0, mismatch: 0, extraneous: 0
[STATUS] starting verify on public.test_table, shard 2/4, range: [1 - 1)
[STATUS] finished row verification on public.test_table (shard 2/4): truth rows seen: 0, success: 0, missing: 0, mismatch: 0, extraneous: 0
[STATUS] starting verify on public.test_table, shard 3/4, range: [1 - 1)
[STATUS] finished row verification on public.test_table (shard 3/4): truth rows seen: 0, success: 0, missing: 0, mismatch: 0, extraneous: 0
[STATUS] starting verify on public.test_table, shard 4/4, range: [1 - <end>]
[STATUS] finished row verification on public.test_table (shard 4/4): truth rows seen: 2, success: 2, missing: 0, mismatch: 0, extraneous: 0
